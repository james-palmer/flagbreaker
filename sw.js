const version = 2.0;

if ('serviceWorker' in navigator) {
    window.addEventListener('load', function () {
        navigator.serviceWorker.register('sw.js').then(function (registration) {
            console.log('Service worker successfully registered on scope', registration.scope);
            console.log('Version', version);
        }).catch(function (error) {
            console.log('Service worker failed to register');
            console.log('Version', version);
            window.location.pathname;
        });
    });
}

var cacheName = 'flagbreaker';
var filesToCache = [
  'index.html',
  'public/main.css',
  'public/main.js',
  'flag_names/ad.png',
  'flag_names/ae.png',
  'flag_names/af.png',
  'flag_names/ag.png',
  'flag_names/ai.png',
  'flag_names/al.png',
  'flag_names/am.png',
  'flag_names/ao.png',
  'flag_names/aq.png',
  'flag_names/ar.png',
  'flag_names/as.png',
  'flag_names/at.png',
  'flag_names/au.png',
  'flag_names/aw.png',
  'flag_names/ax.png',
  'flag_names/az.png',
  'flag_names/ba.png',
  'flag_names/bb.png',
  'flag_names/bd.png',
  'flag_names/be.png',
  'flag_names/bf.png',
  'flag_names/bg.png',
  'flag_names/bh.png',
  'flag_names/bi.png',
  'flag_names/bj.png',
  'flag_names/bl.png',
  'flag_names/bm.png',
  'flag_names/bn.png',
  'flag_names/bo.png',
  'flag_names/bq.png',
  'flag_names/br.png',
  'flag_names/bs.png',
  'flag_names/bt.png',
  'flag_names/bv.png',
  'flag_names/bw.png',
  'flag_names/by.png',
  'flag_names/bz.png',
  'flag_names/ca.png',
  'flag_names/cc.png',
  'flag_names/cd.png',
  'flag_names/cf.png',
  'flag_names/cg.png',
  'flag_names/ch.png',
  'flag_names/ci.png',
  'flag_names/ck.png',
  'flag_names/cl.png',
  'flag_names/cm.png',
  'flag_names/cn.png',
  'flag_names/co.png',
  'flag_names/cr.png',
  'flag_names/cu.png',
  'flag_names/cv.png',
  'flag_names/cw.png',
  'flag_names/cx.png',
  'flag_names/cy.png',
  'flag_names/cz.png',
  'flag_names/de.png',
  'flag_names/dj.png',
  'flag_names/dk.png',
  'flag_names/dm.png',
  'flag_names/do.png',
  'flag_names/dz.png',
  'flag_names/ec.png',
  'flag_names/ee.png',
  'flag_names/eg.png',
  'flag_names/eh.png',
  'flag_names/er.png',
  'flag_names/es.png',
  'flag_names/et.png',
  'flag_names/eu.png',
  'flag_names/fi.png',
  'flag_names/fj.png',
  'flag_names/fk.png',
  'flag_names/fm.png',
  'flag_names/fo.png',
  'flag_names/fr.png',
  'flag_names/ga.png',
  'flag_names/gb-eng.png',
  'flag_names/gb-nir.png',
  'flag_names/gb-sct.png',
  'flag_names/gb-wls.png',
  'flag_names/gb.png',
  'flag_names/gd.png',
  'flag_names/ge.png',
  'flag_names/gf.png',
  'flag_names/gg.png',
  'flag_names/gh.png',
  'flag_names/gi.png',
  'flag_names/gl.png',
  'flag_names/gm.png',
  'flag_names/gn.png',
  'flag_names/gp.png',
  'flag_names/gq.png',
  'flag_names/gr.png',
  'flag_names/gt.png',
  'flag_names/gu.png',
  'flag_names/gw.png',
  'flag_names/gy.png',
  'flag_names/hk.png',
  'flag_names/hn.png',
  'flag_names/hr.png',
  'flag_names/ht.png',
  'flag_names/hu.png',
  'flag_names/id.png',
  'flag_names/ie.png',
  'flag_names/il.png',
  'flag_names/im.png',
  'flag_names/in.png',
  'flag_names/iq.png',
  'flag_names/ir.png',
  'flag_names/is.png',
  'flag_names/it.png',
  'flag_names/je.png',
  'flag_names/jm.png',
  'flag_names/jo.png',
  'flag_names/jp.png',
  'flag_names/ke.png',
  'flag_names/kg.png',
  'flag_names/kh.png',
  'flag_names/ki.png',
  'flag_names/km.png',
  'flag_names/kn.png',
  'flag_names/kp.png',
  'flag_names/kr.png',
  'flag_names/kw.png',
  'flag_names/ky.png',
  'flag_names/kz.png',
  'flag_names/la.png',
  'flag_names/lb.png',
  'flag_names/lc.png',
  'flag_names/li.png',
  'flag_names/lk.png',
  'flag_names/lr.png',
  'flag_names/ls.png',
  'flag_names/lt.png',
  'flag_names/lu.png',
  'flag_names/lv.png',
  'flag_names/ly.png',
  'flag_names/ma.png',
  'flag_names/mc.png',
  'flag_names/md.png',
  'flag_names/me.png',
  'flag_names/mf.png',
  'flag_names/mg.png',
  'flag_names/mh.png',
  'flag_names/mk.png',
  'flag_names/ml.png',
  'flag_names/mm.png',
  'flag_names/mn.png',
  'flag_names/mo.png',
  'flag_names/mp.png',
  'flag_names/mq.png',
  'flag_names/mr.png',
  'flag_names/ms.png',
  'flag_names/mt.png',
  'flag_names/mu.png',
  'flag_names/mv.png',
  'flag_names/mw.png',
  'flag_names/mx.png',
  'flag_names/my.png',
  'flag_names/mz.png',
  'flag_names/na.png',
  'flag_names/nc.png',
  'flag_names/ne.png',
  'flag_names/nf.png',
  'flag_names/ng.png',
  'flag_names/ni.png',
  'flag_names/nl.png',
  'flag_names/no.png',
  'flag_names/np.png',
  'flag_names/nr.png',
  'flag_names/nu.png',
  'flag_names/nz.png',
  'flag_names/om.png',
  'flag_names/pa.png',
  'flag_names/pe.png',
  'flag_names/pf.png',
  'flag_names/pg.png',
  'flag_names/ph.png',
  'flag_names/pk.png',
  'flag_names/pl.png',
  'flag_names/pm.png',
  'flag_names/pn.png',
  'flag_names/pr.png',
  'flag_names/ps.png',
  'flag_names/pt.png',
  'flag_names/pw.png',
  'flag_names/py.png',
  'flag_names/qa.png',
  'flag_names/re.png',
  'flag_names/ro.png',
  'flag_names/rs.png',
  'flag_names/ru.png',
  'flag_names/rw.png',
  'flag_names/sa.png',
  'flag_names/sb.png',
  'flag_names/sc.png',
  'flag_names/sd.png',
  'flag_names/se.png',
  'flag_names/sg.png',
  'flag_names/si.png',
  'flag_names/sj.png',
  'flag_names/sk.png',
  'flag_names/sl.png',
  'flag_names/sm.png',
  'flag_names/sn.png',
  'flag_names/so.png',
  'flag_names/sr.png',
  'flag_names/ss.png',
  'flag_names/st.png',
  'flag_names/sv.png',
  'flag_names/sy.png',
  'flag_names/sz.png',
  'flag_names/td.png',
  'flag_names/tg.png',
  'flag_names/th.png',
  'flag_names/tj.png',
  'flag_names/tk.png',
  'flag_names/tl.png',
  'flag_names/tm.png',
  'flag_names/tn.png',
  'flag_names/to.png',
  'flag_names/tr.png',
  'flag_names/tt.png',
  'flag_names/tv.png',
  'flag_names/tw.png',
  'flag_names/tz.png',
  'flag_names/ua.png',
  'flag_names/ug.png',
  'flag_names/us.png',
  'flag_names/uy.png',
  'flag_names/uz.png',
  'flag_names/vc.png',
  'flag_names/ve.png',
  'flag_names/vg.png',
  'flag_names/vn.png',
  'flag_names/vu.png',
  'flag_names/wf.png',
  'flag_names/ws.png',
  'flag_names/xk.png',
  'flag_names/ye.png',
  'flag_names/yt.png',
  'flag_names/za.png',
  'flag_names/zm.png',
  'flag_names/zw.png'

];
self.addEventListener('install', function(e) {
  console.log('[ServiceWorker] Install');
  e.waitUntil(
    caches.open(cacheName).then(function(cache) {
      console.log('[ServiceWorker] Caching app shell');
      return cache.addAll(filesToCache);
    })
  );
});
self.addEventListener('activate',  event => {
  event.waitUntil(self.clients.claim());
});
self.addEventListener('fetch', event => {
  event.respondWith(
    caches.match(event.request, {ignoreSearch:true}).then(response => {
      return response || fetch(event.request);
    })
  );
});